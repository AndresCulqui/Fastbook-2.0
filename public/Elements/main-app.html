<polymer-element name="main-app">
	<template>
		<style>
		core-drawer-panel{
	
			}
		
			my-head /deep/ #title{
				font-size: 60px;
			}

			#drawer{
				position: absolute;
				background-color: whitesmoke;
				border-radius: 7px;
				height: 100%;
				z-index: 10;
			}
			#main{
				border:2px solid red;
				
			}
			#container{
					border:2px solid green;
					
			}
			#mn{
				position: fixed;
			}
			core-toolbar {
     		 // float: left;
      			width: 100%;
      			height: 60px;
		        background: rgb(255,123,13); /* Old browsers */
		        background: -moz-linear-gradient(top,  rgba(255,123,13,1) 0%, rgba(255,168,76,1) 60%); /* FF3.6+ */
		        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,123,13,1)), color-stop(60%,rgba(255,168,76,1))); /* Chrome,Safari4+ */
		        background: -webkit-linear-gradient(top,  rgba(255,123,13,1) 0%,rgba(255,168,76,1) 60%); /* Chrome10+,Safari5.1+ */
		        background: -o-linear-gradient(top,  rgba(255,123,13,1) 0%,rgba(255,168,76,1) 60%); /* Opera 11.10+ */
		        background: -ms-linear-gradient(top,  rgba(255,123,13,1) 0%,rgba(255,168,76,1) 60%); /* IE10+ */
		        background: linear-gradient(to bottom,  rgba(255,123,13,1) 0%,rgba(255,168,76,1) 60%); /* W3C */
		        color: #fff;
		      
		     }

		</style>


	<core-drawer-panel id="cdp"responsiveWidth="2000px" >
	
	<div drawer id="drawer" >
	<mobile-menu id="momenu"pages="{{pages}}" user="{{user}}"></mobile-menu>

	</div>
	   

	

<core-header-panel  main  mode="waterfall">
<core-toolbar>
  <my-head id="mh" lang="en" mtitle="FastBook"></my-head>
  	<core-icon-button id="cib"  src="http://tediselmedical.com/wp-content/uploads/2013/11/Spain.png"icon="menu" on-tap=" {{languaje}} " id="languaje" > </core-icon-button>
      <google-signin on-tap="{{loginGoogle}}" id="gs" theme="dark" width="iconOnly"   clientId="768969970497-j73ejp1juep7a0lm1s8tmn284mg9ogmg.apps.googleusercontent.com" scopes="email"></google-signin>
 </core-toolbar> 
  <my-banner id="mb" lang="en"></my-banner>

	<div id="container">


		<core-animated-pages id="cap" valueattr="hash" selected="{{route}}"
					transitions="slide-from-right">
			
			<section  hash="home">
					<core-animation id="ca"></core-animation>

			</section >
			<section  hash="search">
					<core-search></core-search>
			</section >

			<section  hash="buy">
					
					<mi-biblioteca></mi-biblioteca>
			</section>
			<section  hash="sell">
					
					<sell-element></sell-element>
			</section>
			<section  hash="account">
					<!--<core-perfil></core-perfil>-->
					<fast-account id="fa"></fast-account>
				
			</section>
			<section  hash="sign">	
			</section>
		</core-animated-pages>

	</div>

  </core-header-panel>

</core-drawer-panel>
</template>
	<script>
	    


//--------------------------escuchando eventos------------------------

	Polymer({
		ready:function() {

			this.pages=this.$.mh.pages;
			this.$.mh.lang="en";
			this.$.mb.lang="en";
	


			var that=this;
			//console.log(this.$.mh.lang),
			

			//console.log(this.route);

			//-------------------escuchando evento boton menu left-----------------------
			this.$.mh.addEventListener('actionMenu', function() {
		    	that.$.cdp.togglePanel();
		  	});
		  	//-------------------escuchando evento menu principal-----------------------
			this.$.mh.addEventListener('mainMenu', function(e) {
		    	
		    	that.route=e.detail;

		    	
		  	});
		  	//-------------------escuchando evento menu left-----------------------
			this.$.momenu.addEventListener('leftMenu', function(e) {
		    	
		    	that.route=e.detail;
		    	that.$.cdp.closeDrawer();
		    	
		  	});
		  	//-------------------escuchando evento slected-book-----------------------
			this.$.ca.addEventListener('selectedBook', function(e) {
		    	
		    	console.log(e.detail.alt+"           soy evento ");
		    	
		    	
		  	});	
      //--------------------------escuchando evento load profile-----------------------
      /*this.$.fa.addEventListener('profile-load',function(e){
        console.log(e.detail.name+"  soy profile en main");
        that.user=e.detail;
      });*/
    
    //------------------escuchando evento si ehay conexion----------------
              var that=this;
         this.$.gs.addEventListener('google-signin-success', function(e) {
       
              var y=e.detail;
              console.log(y.result.access_token+"          token");
              y.gapi.client.request({path:'/plus/v1/people/me', method:'GET', callback: function(result) {
                  
                var token={id:result.id, token:y.result.access_token};
                
                $.post('/googleUser',token, function(data,status){
                 
                      if (status){
                 
                      
                     
                     // var datajson=jQuery.parseJSON(data);
                      
                     console.log(data);
                       
                         that.user={id:data.password,name:data.name, email:data.email, photo:result.image.url};
                     
                 
                      
                      
                    }else{
                      alert("error¡¡¡¡------------------------->");
                    }
                     
                    });
                    
                    
                
        
              }});
     ///--------------------------->------> si se desconecta-->revokar token----->
            
                  var revokeUrl = 'https://accounts.google.com/o/oauth2/revoke?token='+y.result.access_token;
                        

            
                  that.$.gs.addEventListener('google-signed-out',function(e,f,g){
               console.log(e.returnValue+"soy return valueeee si esta desconectado");
               if(e.returnValue){
                 
                 $.ajax({
                        type: 'GET',
                        url: revokeUrl,
                        async: false,
                        contentType: "application/json",
                        dataType: 'jsonp',
                        success: function() {
                          location.reload();  
                        },
                        error: function(e) {

                        }
                      }); 
                   
                 console.log("soy true");
               }else{
                 console.log("soy false");
               }
          
        });
              
        });
   
   
         
      
      
		},
		languaje: function  (a,b,c) {

			if(this.$.mh.lang=="en"){
				this.$.mh.lang="es";
				this.$.mb.lang="es";
				this.$.mh.ready();
				this.$.momenu.pages=this.$.mh.pages;
				this.$.cib.src="http://tediselmedical.com/wp-content/uploads/2013/11/United_Kingdom.png";
			}else if(this.$.mh.lang=="es"){
				this.$.mb.lang="en";
				this.$.mh.lang="en";
				this.$.mh.ready();
				this.$.momenu.pages=this.$.mh.pages;
				this.$.cib.src="http://tediselmedical.com/wp-content/uploads/2013/11/Spain.png";
			}
		
			this.$.mb.languaje(this.$.mh.lang);
		}



	});
	</script>
</polymer-element>